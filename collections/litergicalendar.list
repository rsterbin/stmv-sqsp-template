<div><pre style="color: blue;">console.log({@|json-pretty})</pre></div>
{.var @firstDate items.0.startDate}

<div class="row column subtitle">
    <h3>Monthly Worship Schedule: {@firstDate|date %B %Y}</h3>
</div>

<div class="row calendar-nav">
    <div class="small-4 large-5 columns prev">
        <a href="{pagination.prevPageUrl|htmlattr}" title="Previous Month"><i class="fa fa-chevron-left"></i></a>
    </div>
    <div class="small-4 large-2 columns current">{@firstDate|date %B %Y}</div>
    <div class="small-4 large-5 columns next">
        <a href="{pagination.prevPageUrl|htmlattr}" title="Next Month"><i class="fa fa-chevron-right"></i></a>
    </div>
</div>

{.var @currentDay empty}

{.repeated section items}
  {.var @itemDay startDate|date %e}
  {.equal?:@currentDay:@itemDay}
    {.var @doStartWrapper false}
    {.var @doEndWrapper false}
  {.or}
    {.var @doDoStartWrapper true}
    {.equal?:@currentDay:empty}
      {.var @doEndWrapper true}
    {.or}
      {.var @doEndWrapper false}
    {.end}
  {.end}

  {.var @currentDay startDate|date %B}

  {.if @doEndWrapper}
                </div>
            </div>
        </div>
    </div>
</div>
  {.end}

  {.if @doStartWrapper}
<div class="row">
    <div class="large-8 large-centered columns">
        <div class="lcal-month-day">
            <div class="row">
                <div class="small-12 medium-2 columns">
                    <div class="calendar-date">
                        <span class="badge number">{startDate|date %e}</span>
                        <span class="weekday">{startDate|date %A}</span>
                    </div>
                </div>
                <div class="small-12 medium-10 columns">
  {.end}

                    <div class="service{.repeated section tags} {@|url-encode|htmlattr}{.end}">
                        <div class="title"><a href="{fullUrl|htmlattr}">{title|htmltag}</a></div>
                        <div class="excerpt">
                            {body}
                        </div>
                    </div>
{.end}

{# If currentDay is still empty, no need to close the last item in the loop }
{.equal?:@currentDay:empty}
{.or}
                </div>
            </div>
        </div>
    </div>
</div>
{.end}

